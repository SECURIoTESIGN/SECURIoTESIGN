# File Upload

## Overview

File uploading is one of the most important mechanisms in any application, be it web, hybrid mobile, or native. This mechanism ensures that the user is able to upload his photo, his cv, video, etc.

## Good Practices

To ensure that secure file uploading, the following principles should be followed:

* List allowed extensions. Only allow safe and critical extensions for business functionality
    - Ensure that [input validation](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html) is applied before validating the extensions;
* Validate the file type, don't trust the [Content-Type header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) as it can be spoofed;
* Change the filename to something generated by the application;
* Set a filename length limit. Restrict the allowed characters if possible;
* Set a file size limit;
* Only allow authorized users to upload files;
* Store the files on a different server. If that's not possible, store them outside of the webroot
    - In the case of public access to the files, use a handler that gets mapped to filenames inside the application (someid -> file.ext).
* Run the file through an antivirus or a sandbox if available to validate that it doesn't contain malicious data;
* Ensure that any libraries used are securely configured and kept up to date;
* Protect the file upload from [CSRF](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html) attacks.

## References
- [File Upload - OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html)